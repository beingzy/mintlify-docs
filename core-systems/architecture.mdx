---
title: Core System Architecture
description: "From data creation to royalties — the end-to-end lifecycle: Contribution Fingerprint → Identity → Reputation → Lineage → Storage/Compute/Serving → Access & Metering → Tokenized Ownership → Royalty Engine."
---

> **TL;DR**  
> Codatta turns human/agent contributions into **verifiable, ownable data assets** with traceable lineage, policy-gated & observable access, provable ownership, and **deterministic royalty payouts**.

## Architecture

```mermaid
flowchart LR
  %% LAYOUT DIRECTION
  %% Use LR (left→right) to mirror the supplied chart

  %% =========================
  %% NODES (grouped by type)
  %% =========================

  %% --- Actors / Roles (yellow)
  KC[Knowledge Contributors<br/>(Providers / Validators)]
  DC[Data Consumer<br/>(AI Model Developer)]
  OH[Ownership Holders]
  U[Users]

  %% --- Core blue modules
  ID[Identity]
  REP[Reputation]
  CF[Contribution Fingerprint]
  PAC[Permissioned Access Control]
  MET[Metering Module]
  LEX[Data Lineage Explorer]
  TOK[Tokenized Ownership]
  ODFI[Ownership DeFi Marketplace]
  DStor[Decentralized Storage<br/>(Source-of-truth)]
  Cloud[Cloud Computing]
  Gate[Access Endpoint]
  TEE[TEE or Federated Learning]
  AIM[AI Model]
  RM[Royalty Module]
  PT[Protocol Treasury]
  RA[Revenue Accounts]

  %% =========================
  %% FLOWS / EDGES
  %% =========================

  %% Identity & Reputation inform contributions
  ID --> REP
  KC --> CF
  REP --> CF

  %% CF persists and becomes discoverable
  CF --> DStor
  CF --> LEX

  %% Access control and serving path
  LEX --> PAC
  DC --> PAC
  PAC --> Gate
  Gate --> Cloud
  Cloud --> TEE
  TEE --> AIM
  AIM --> U

  %% Metering & billing events
  Gate --> MET

  %% Ownership lifecycle
  KC --> TOK
  TOK --> OH
  TOK <---> ODFI

  %% Royalties
  MET --> RM
  TOK --> RM
  RM --> OH
  RM --> PT
  RM --> RA

  %% =========================
  %% STYLES (optional, to resemble the diagram)
  %% =========================
  classDef role fill:#F6C667,stroke:#d9a52c,color:#111,stroke-width:1px;
  classDef module fill:#66B8F6,stroke:#2b82c9,color:#111,stroke-width:1px;
  classDef model fill:#7EDB86,stroke:#3aa24a,color:#111,stroke-width:1px;
  classDef revenue fill:#F79B5F,stroke:#d26d2d,color:#111,stroke-width:1px;

  class KC,DC,OH,U role;
  class ID,REP,CF,PAC,MET,LEX,TOK,ODFI,DStor,Cloud,Gate,TEE,RM,PT,RA module;
  class AIM model;
  class RA revenue;
```


## Roles

- **Knowledge Contributors** *(providers & validators; human or autonomous agents)* — create/verify contributions and may stake on accuracy.
- **Knowledge Backers** — underwrite contributor cohorts or datasets; share in ownership and royalties.
- **Data Consumers (AI builders)** — license datasets via policy-gated endpoints; usage generates billable events.

> Also present in flows: **Ownership Holders**, **Protocol Treasury**, **Revenue Accounts**, **Users**.

## Lifecycle (data → ownership → royalties)

1. **Contribution Fingerprint (CF)** — atomic, signed record of **who did what, when, with what evidence**.
2. **Identity** — bind actors (wallet/DID; optional credentials) with privacy modes and auditable boundaries.
3. **Reputation** — trust signal from accuracy history, credentials/skills, and staking-as-confidence.
4. **Lineage & Explorer** — compose CFs into versioned datasets; provenance queries power explainability.
5. **Storage / Compute / Serving** — source-of-truth persistence, secure compute (TEE/federated), and access gateway.
6. **Access & Metering** — policy checks gate reads; metering emits **usage & billing events** with dataset/version IDs.
7. **Tokenized Ownership** — contributors/backers hold fractions over units/datasets; fractions are tradable/liquid.
8. **Royalty Engine** — transforms revenue + events + ownership state into deterministic, explainable payouts.

<Tip>
**Data Valuation & Attribution**:

**Valuation** *(how access is priced/weighted, versioned)*: quality/accuracy (source class, agreement, validator rep.), information richness (incremental info gain), demand & scarcity, market references (tier/SKU benchmarks), protocol distribution parameters (governance weights), novelty/recency. Each dataset/version caches an **Effective Price/Weight** used by metering events.

**Attribution** *(who gets paid at time `t`)*: ownership fractions for the specific unit/dataset at the **event’s effective timestamp** (version-pinned), plus hold-backs/reserves for disputes and a governed treasury share.

**Determinism:** *same* metering events + *same* ownership state + *same* valuation config ⇒ *same* payout result on replay.
</Tip>

## Interfaces (module contracts)

- **CF → Identity / Reputation** — signers; validation feeds reputation.
- **CF / Reputation → Lineage** — inclusion and weighting rules.
- **Lineage → Storage / Serving** — materialized datasets & versions.
- **Access Gateway → Metering** — emits usage & billing events with dataset/version IDs.
- **Tokenized Ownership ↔ Royalty Engine** — fractions at time *t*, dispute/escrow states.
- **Royalty Engine → Owners/Task Creators/Treasury** — explainable payouts with audit trails.

## Invariants

- **Traceability:** every served byte maps to a lineage node → CFs → owners.
- **Determinism:** event + ownership + valuation config = identical payout on replay.
- **Minimal disclosure:** identity/access proofs reveal only what policy requires.
- **Revocability with audit:** disputes quarantine revenue and allow recomputation without data loss.
